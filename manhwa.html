<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manhwa Website</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="title">
            <a href="./index.html" class="no-hover">
                <h1>Daniel's Manhwa Website</h1>
            </a>
        </div>
        <nav>
            <div id="nav-options"> 
                <a href="./index.html">Home</a>
                <a href="./manhwa.html">All Manhwa</a>
                <a href="./about.html">About</a>
                <!-- <a href="./login.php" id="login-link">Login</a>
                <a href="./signup.php" id="signup-link">Signup</a>
                <a href="./logout.php" id="logout-link" style="display: none;">Logout</a> -->
            </div>
            <a href="#" id="menu-icon">&#9776;</a>
            <div id="dropdown-menu" style="display: none;">
                <a id="close">X</a>
                <div>
                    <a id="top" href="./index.html">Home</a>
                    <a href="./manhwa.html">All Manhwa</a>
                    <a href="./about.html">About</a>
                    <!-- <a href="./login.php" id="login-link">Login</a>
                    <a href="./signup.php" id="signup-link">Signup</a>
                    <a href="./logout.php" id="logout-link">Logout</a> -->
                </div>
            </div>
        </nav>
    </header>
    <main>
        <div class="page-container">
            <section id="all-manhwa">
                <h2><span>A</span><span>L</span><span>L</span>
                    <span>M</span><span>A</span><span>N</span><span>H</span><span>W</span><span>A</span>
                </h2>
                <div id="color-scheme" style="text-align: center"><u>Color Scheme:</u> 
                    <ul>
                        <li>
                            <div class='box red'></div>
                            <p>= Hiatus</p>
                        </li>
                        <li>
                            <div class='box yellow'></div>
                            <p>= Unread</p>
                        </li>
                        <li>
                            <div class='box orange'></div>
                            <p>= Unknown Rating</p>
                        </li>
                        <li>
                            <div class='box blue'></div>
                            <p>= Completed Series</p>
                        </li>
                    </ul>
                </div>
                <div id="sorting-header">
                    <div id="center-options">
                        <div class="search">
                            <h3>Search By Title Name: </h3>
                            <input type="text" id="search-input" placeholder="Type Here...">
                        </div>
                        <div id="sort-reset-container">
                            <select id="sort-options">
                                <option value="none">(Sort By)</option>
                                <option value="alphabetical">Alphabetical</option>
                                <option value="width-desc">Rating (High -> Low)</option>
                                <option value="width-asc">Rating (Low -> High)</option>
                            </select>          
                            <button id="reset-button" class="btn-shine">
                                <span>Reset (Recently Read)</span>
                            </button>
                        </div>
                        <div id="loading">Loading...</div>
                    </div>
                    
                </div>
                
                <div id="manhwa-list"></div>
            </section>
        </div>
    </main>
    <div id="footer"></div>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <script src="header.js"></script> -->
    <script src="allmanhwa.js"></script>
    <script src="footer.js"></script>
    <script>
        $(document).ready(function(){
            // STANDARD FOR ALL PAGES DUE TO HEADER //
            // For dropdown Menu
            $("#menu-icon").click(function() {
                $("#dropdown-menu").slideToggle();
            });

            $("#close").click(function() {
                $("#dropdown-menu").slideToggle();
            });
            // STANDARD FOR ALL PAGES DUE TO HEADER //

            // For Sorting (Exclusive to manhwa.html)
            var originalItems = $(".item").get();
            $("#sort-options").change(function() {
                var option = $(this).val();
                sortItems(option);
            });
            $("#reset-button").click(function() {
                resetItems();
            });

            function resetItems() {
                $("#manhwa-list").empty().append(originalItems);
                $("#sort-options").val("none");
            }
            function sortItems(option) {
                $("#loading").show(); // Show loading icon
                $("#sort-options").attr("disabled", true); // disable the sorting menu
                var items = $(".item");
                if (option === "alphabetical") {
                    items.sort(function(a, b) {
                        var textA = $(a).find("h3").text();
                        var textB = $(b).find("h3").text();
                        return textA.localeCompare(textB);
                    });
                } else if (option === "width-asc") {
                    items.sort(function(a, b) {
                        var widthA = parseInt($(a).find(".progress").width());
                        var widthB = parseInt($(b).find(".progress").width());
                        return widthA - widthB;
                    });
                } else if (option === "width-desc") {
                    items.sort(function(a, b) {
                        var widthA = parseInt($(a).find(".progress").width());
                        var widthB = parseInt($(b).find(".progress").width());
                        return widthB - widthA;
                    });
                } else {
                    resetItems();
                }
                $("#manhwa-list").empty().append(items);
                $("#loading").hide(); // Hide loading icon
                $("#sort-options").attr("disabled", false); // enable the sorting menu
            }

            // For the Search Function and updates count
            const container = document.querySelector('#manhwa-list');
            const searchInput = document.querySelector('#search-input');
            const count = document.querySelector('#count');

            searchInput.addEventListener('input', handleSearch);
            function handleSearch() {
                const query = searchInput.value.trim().toLowerCase();
                const items = container.querySelectorAll('.item');

                let visibleItems = 0;
                items.forEach(item => {
                    const title = item.querySelector('h3').textContent.trim().toLowerCase();

                    if (title.includes(query)) {
                        item.style.display = 'block';
                        visibleItems++;
                    } else {
                        item.style.display = 'none';
                    }
                });
                count.textContent = "Total Count: " + visibleItems;
            }
        });
</script>
</html>
